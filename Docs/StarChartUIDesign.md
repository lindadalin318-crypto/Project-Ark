# 🚀 星图 UI 设计方案 — Star Chart UI Design

**文档版本**：v1.0  
**创建日期**：2026-02-16  
**项目**：静默方舟 (Project Ark)  
**屏幕比例**：16:9 横版

---

## 核心理念

**「金丝雀号驾驶舱界面」** — 把星图 UI 变成飞船的**装备校准台**，每一步操作都有仪式感。

---

## 一、16:9 横版专属布局

### 布局总览（加特林枪管旋转系统）⭐️

```
┌─────────────────────────────────────────────────────────────────┐
│  [系统状态：在线]  金丝雀号 — 星图校准系统  [☓]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │                    武器轨道视图（上半区）                │  │
│  │                                                           │  │
│  │  ┌───┬───────────────────────────────────────────────┐  │  │
│  │  │ ▲ │  ◎  LOADOUT #1  —  突击配置              │  │  │
│  │  │   │  ┌─────────────────────────────────────────┐ │  │  │
│  │  │   │  │  PRIMARY  ┌───┬───┬───┬───┬───┐      │ │  │  │
│  │  │   │  │           │◎  │◇  │◇  │◇  │◇  │      │ │  │  │
│  │  │   │  │           └───┴───┴───┴───┴───┘      │ │  │  │
│  │  │   │  ├─────────────────────────────────────────┤ │  │  │
│  │  │   │  │  SECONDARY  ┌───┬───┬───┬───┬───┐    │ │  │  │
│  │  │   │  │             │◎  │◇  │◇  │◇  │◇  │    │ │  │  │
│  │  │   │  │             └───┴───┴───┴───┴───┘    │ │  │  │
│  │  │   │  └─────────────────────────────────────────┘ │  │  │
│  │  │ ▼ │  (Loadout #1 / 3)                           │  │  │
│  │  └───┴───────────────────────────────────────────────┘  │  │
│  │                                                           │  │
│  └─────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │                    部件库存（下半区）                        │  │
│  │                                                             │  │
│  │  [核心] [棱镜] [光帆] [伴星]  [保存配置] [重命名] [删除] │  │
│  │                                                             │  │
│  │  ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐          │  │  │
│  │  │[◎]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│          │  │  │
│  │  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤          │  │  │
│  │  │[◎]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│          │  │  │
│  │  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤          │  │  │
│  │  │[◎]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│[◇]│          │  │  │
│  │  └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘          │  │  │
│  │                                                             │  │
│  └─────────────────────────────────────────────────────────┘  │
│                                                                 │
│                    （悬停浮窗在鼠标附近显示）                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### 加特林枪管旋转系统 ⭐️⭐️⭐️

#### 概念说明

| 概念 | 说明 |
|------|------|
| **Loadout（配置）** | 一套完整的武器组合 = 主武器 + 副武器 |
| **枪管旋转** | 点击切换按钮时，像加特林机枪枪管一样旋转到下一个配置 |
| **配置数量** | 支持 3-5 个配置（可扩展） |
| **参考** | 类似 *Borderlands* 的武器轮盘，但视觉是加特林枪管 |

---

#### 切换按钮设计（侧边上下按钮）

```
┌───┐
│ ▲ │  ← 上一个配置
│   │
│ ▼ │  ← 下一个配置
└───┘
```

- **上按钮 [▲]**：切换到上一个配置
- **下按钮 [▼]**：切换到下一个配置
- **位置**：放在轨道视图的左侧（或右侧）
- **视觉风格**：金属质感 + 齿轮/枪管图标

---

#### 枪管旋转动效（核心！）⭐️

**参考视角**：从侧面观察加特林机枪的枪管（垂直方向旋转）

```
切换前（当前配置）：
    [配置 1]  ← 在前面，清晰可见

点击 [▲] 切换 → 开始旋转：
    [配置 1]  ← 向上方旋转出去（淡出 + 缩小 + 上移）
    [配置 2]  ← 从下方旋转进来（淡入 + 放大 + 下移）

旋转中：
    两个配置同时在"旋转"
    中间有"枪管"的视觉辅助线
    播放机械转动的音效

切换完成：
    [配置 2]  ← 在前面，清晰可见

---
点击 [▼] 切换则相反方向旋转
```

---

#### 旋转动画细节

| 阶段 | 时长 | 效果 |
|------|------|------|
| **旋转开始** | 0.1s | 当前配置向上倾斜 15° |
| **旋转中** | 0.4s | 两个配置同时旋转 180°（垂直方向） |
| **旋转结束** | 0.1s | 新配置向下回正 |
| **总时长** | **0.6s** | 干脆利落，不拖沓 |

---

#### 视觉辅助元素

- **枪管轮廓**：旋转时显示加特林枪管的轮廓线
- **旋转方向指示器**：箭头显示旋转方向（左/右）
- **震动效果**：UI 轻微震动，模拟机械转动
- **光影变化**：旋转时光影从左侧转到右侧

---

#### 音效

| 事件 | 音效 |
|------|------|
| 点击切换按钮 | 「咔嚓」机械声 |
| 旋转中 | 持续的「嗡嗡」机械转动声 |
| 旋转完成 | 「咔嗒」锁定声 |

---

#### 配置管理

| 功能 | 说明 |
|------|------|
| **保存配置** | 把当前装备保存为一个新配置 |
| **重命名配置** | 给配置起名字（如「突击」、「狙击」、「霰弹」） |
| **删除配置** | 删除不需要的配置 |
| **快速切换** | 键盘快捷键 `Q` / `E` 快速切换配置 |

---

---

### 背包乱斗风格特点 ⭐️

| 特点 | 说明 |
|------|------|
| **紧凑布局** | 槽位之间几乎没有间距（间距 &lt; 4px） |
| **网格对齐** | 所有槽位严格对齐，像棋盘一样 |
| **统一尺寸** | 所有槽位大小一致（核心、棱镜都是 1x1） |
| **视觉密集** | 整体感觉很"挤"，充满策略感 |
| **参考** | 类似 *Backpack Battles*、*Into the Breach* 的背包布局 |

### 区域划分（按高度）

| 区域 | 高度占比 | 功能 |
|------|---------|------|
| **上半区** | ~45% | 武器轨道视图（视觉焦点） |
| **下半区** | ~55% | 部件库存（操作区） |

---

## 二、悬停浮窗设计 ⭐️

### 浮窗特点

| 特性 | 说明 |
|------|------|
| **显示时机** | 鼠标悬停在物品上 0.15 秒后显示 |
| **消失时机** | 鼠标离开物品后立即消失 |
| **跟随鼠标** | 浮窗跟随鼠标移动，但不超出屏幕 |
| **切换动画** | 从一个物品移到另一个时，浮窗「淡入淡出」切换内容 |
| **智能定位** | 自动调整位置，避免超出屏幕边界 |

### 浮窗内容

```
┌─────────────────────────────────────┐
│  [物品图标]  脉冲核心 MK-II      │  ← 图标 + 名称
│  ───────────────────────────────   │
│  类型：Star Core                  │  ← 类型标签（彩色）
│                                   │
│  • 伤害 +25%                      │  ← 属性列表（带 ↑/↓ 箭头）
│  • 射速 -10%                      │
│  • 穿透 +1                        │
│                                   │
│  "高频能量核心，提升伤害但     │  ← 描述文本（灰色）
│   略降射速"                        │
└─────────────────────────────────────┘
```

### 已装备物品的浮窗

```
┌─────────────────────────────────────┐
│  [物品图标]  脉冲核心 MK-II      │
│  [已装备]  PRIMARY TRACK         │  ← 显示已装备状态
│  ───────────────────────────────   │
│  • 伤害 +25%                      │
│  • 射速 -10%                      │
│  • 穿透 +1                        │
│                                   │
│  "点击物品可卸载"                  │  ← 提示文字（可选）
└─────────────────────────────────────┘
```

> **注意**：浮窗是纯信息展示，没有交互按钮。卸载需要点击物品本身（不是浮窗）。

### 浮窗动效（简洁快速版）

> **原则**：高效、简洁、快速，总动画时长 ≤ 0.15 秒

1. **出现时**（0.1 秒）：
   - 透明度从 0 → 1（线性，无缓动）
   - 不做缩放/位移等复杂动画

2. **消失时**（0.08 秒）：
   - 透明度从 1 → 0（线性，无缓动）
   - 立即隐藏，不做额外动画

3. **切换内容时**（0.05 秒）：
   - 直接切换内容，无动画
   - 只有透明度轻微闪烁（0 → 1）

> **性能优化**：
> - 浮窗 Canvas 设置为 `Constant Pixel Size`
> - 使用对象池复用浮窗（不频繁 Instantiate/Destroy）
> - 关闭 Raycast Target（浮窗不接收点击）

---

## 三、视觉风格

### 紧凑背包布局参数 ⭐️

#### 轨道槽位参数
| 参数 | 值 | 说明 |
|------|-----|------|
| 槽位尺寸 | 64x64 px | 统一大小 |
| 槽位间距 | 2 px | 几乎紧贴 |
| 轨道内边距 | 8 px | 轨道边缘留少量空间 |
| 槽位圆角 | 2 px | 轻微圆角 |

#### 库存槽位参数
| 参数 | 值 | 说明 |
|------|-----|------|
| 槽位尺寸 | 56x56 px | 比轨道略小 |
| 槽位间距 | 2 px | 同样紧凑 |
| 网格列数 | 10-12 列 | 16:9 一行放满 |
| 网格行数 | 3-4 行 | 根据高度调整 |

---

### 动态格子扩展方案 ⭐️⭐️⭐️

#### 问题
主副武器的格子数会**随着游戏进度增加而增加**（比如从 5 格 → 8 格 → 12 格），需要保持美观。

---

#### 方案 A：动态缩放（推荐）⭐️

**原理**：根据格子数量自动调整槽位尺寸，保持整体布局不变。

| 格子数 | 槽位尺寸 | 说明 |
|--------|----------|------|
| 1-5 格 | 64x64 px | 初始大小 |
| 6-8 格 | 56x56 px | 稍微缩小 |
| 9-12 格 | 48x48 px | 进一步缩小 |
| 13-16 格 | 40x40 px | 最小尺寸 |

**优点**：
- 整体布局不变，视觉一致
- 不需要滚动，所有格子都可见
- 简单易实现

**缺点**：
- 格子太多时，图标会变小

---

#### 方案 B：横向扩展（次选）

**原理**：保持槽位尺寸不变，增加列数，超过一定列数后换行。

| 格子数 | 列数 | 行数 |
|--------|------|------|
| 1-5 格 | 5 列 | 1 行 |
| 6-10 格 | 5 列 | 2 行 |
| 11-15 格 | 5 列 | 3 行 |
| 16-20 格 | 5 列 | 4 行 |

**优点**：
- 槽位尺寸保持不变，图标清晰
- 像背包一样自然扩展

**缺点**：
- 轨道高度会增加，可能需要调整整体布局

---

#### 方案 C：混合方案（最优）⭐️⭐️⭐️

**原理**：
1. 先尝试**横向扩展**（增加列数）
2. 列数达到最大（8 列）后，开始**缩小槽位尺寸**
3. 槽位尺寸达到最小（40x40 px）后，开始**换行**

| 格子数 | 列数 | 槽位尺寸 | 行数 |
|--------|------|----------|------|
| 1-8 格 | 8 列 | 64x64 px | 1 行 |
| 9-16 格 | 8 列 | 56x56 px | 1 行 |
| 17-24 格 | 8 列 | 48x48 px | 1 行 |
| 25-32 格 | 8 列 | 40x40 px | 1 行 |
| 33-40 格 | 8 列 | 40x40 px | 2 行 |

**优点**：
- 兼顾了"图标大小"和"布局稳定"
- 最自然的扩展方式

**缺点**：
- 实现稍微复杂一点

---

#### 视觉过渡动画

无论采用哪个方案，当格子数变化时，都需要有平滑的过渡动画：

| 事件 | 动画 |
|------|------|
| **格子解锁** | 新格子从"无"→"有"（缩放 + 淡入） |
| **整体调整** | 所有格子一起动画（缩放/移动），时长 0.3s |
| **图标调整** | 图标随槽位一起缩放 |

---

#### 推荐方案

**采用方案 C（混合方案）**，原因：
- 最符合"游戏进度解锁"的节奏
- 视觉效果最好
- 灵活性最高

---

### 颜色系统

| 用途 | 颜色 |
|------|------|
| 主色调（正常） | 青色/蓝绿色（Cyan） |
| 警告/不可用 | 橙色/黄色 |
| 错误/危险 | 红色 |
| 成功/完成 | 绿色 |
| 背景 | 深蓝/深灰 |
| 文本 | 浅灰/白色 |

### 全息扫描效果

- **背景**：
  - 深色渐变背景（深蓝/深紫/深灰）
  - 动态扫描线（从上往下，缓慢移动，2-3 秒/圈）
  - 轻微的 CRT 噪点
  - 角落有 HUD 风格的装饰边框

- **发光元素**：
  - 装备槽位有「能量涌动」的呼吸灯效果
  - 已装备的部件有向外扩散的辉光
  - 选中状态有「脉冲扫描」的圆环动画

### 字体与排版

- **主标题**：等宽字体（如 `JetBrains Mono`），大写，有字符逐个出现的打字机效果
- **数值显示**：数码管风格的字体（如 `Segment7`）
- **描述文本**：简洁的无衬线字体，行高适中

---

## 四、交互设计

### 1. 打开/关闭动画

**打开流程**：
1. 屏幕中央出现「校准中...」文字（打字机效果）
2. 背景扫描线启动
3. 上半区（轨道）从上方滑入
4. 下半区（库存）从下方滑入
5. 装备槽位逐个「点亮」（从中心向外扩散）
6. 最后「校准完成」提示音

### 2. 拖拽交互动效

- **拿起时**：
  - 部件「悬浮」起来，有轻微的上下浮动
  - 部件放大 110%
  - 显示「能量拖尾」（从原位置到当前鼠标）
  - 播放「拾取」音效

- **悬停在槽位时**：
  - 槽位「呼吸」变亮
  - 显示「可放置」的提示图标
  - 如果槽位已有物品，旧物品「颤抖」提示即将被替换

- **放下时**：
  - 部件「吸附」到槽位，有弹性动画
  - 播放「安装完成」音效
  - 槽位向外发出一圈「能量波」
  - 如果是替换，旧物品「飞向」库存

### 3. 轨道选择（悬停自动选中）⭐️

**移除手动点击选择 → 改为「**鼠标悬停即选中**」

#### 交互逻辑

```
鼠标移到 PRIMARY 轨道区域
    ↓
PRIMARY 轨道自动高亮（放大 105% + 发光）
    ↓
拖拽物品 → 自动放到 PRIMARY 轨道
    ↓
鼠标移到 SECONDARY 轨道区域
    ↓
SECONDARY 轨道自动高亮
    ↓
拖拽物品 → 自动放到 SECONDARY 轨道
```

#### 视觉反馈

| 状态 | 视觉效果 |
|------|-----------|
| **未选中（鼠标不在任何轨道）** | 两个轨道都是正常大小、正常亮度 |
| **悬停在 PRIMARY** | PRIMARY 放大 105% + 高亮 + 发光边框 |
| **悬停在 SECONDARY** | SECONDARY 放大 105% + 高亮 + 发光边框 |

#### 实现要点

- 每个轨道有一个「响应区域」（比轨道本身略大一点，方便悬停）
- 检测 `PointerEnter` / `PointerExit` 事件
- 不需要点击，鼠标移动即触发
- 拖拽物品时，根据物品当前位置判断要放到哪个轨道

---

## 五、新增功能

### 1. 预设配置系统

- **保存配置**：点击「保存预设」→ 保存当前装备组合
- **加载配置**：下拉菜单选择预设 → 一键装备
- **预设命名**：可以给预设起名字（如「近距离爆发」、「远程狙击」）
- **视觉反馈**：加载预设时，物品「逐个飞到位」的动画

### 2. 键盘快捷键

| 键 | 功能 |
|----|------|
| `Page Up` / `Page Down` | 切换配置（上/下，像加特林枪管旋转） |
| `A` / `D` / ← / → | 选择库存物品（左右） |
| `W` / `S` / ↑ / ↓ | 选择库存物品（上下） |
| `Space` / `Enter` | 装备/卸载选中物品 |
| `Esc` | 关闭面板 |

> **注意**：
> - 轨道选择不需要快捷键，鼠标悬停即自动选中
> - `Page Up`/`Page Down` 切换配置时会播放加特林枪管旋转动画

### 3. 音效系统

| 事件 | 音效 |
|------|------|
| 打开面板 | 「系统启动」电子音效 |
| 关闭面板 | 「系统关闭」音效 |
| 拾取物品 | 「能量抓取」音效 |
| 装备物品 | 「安装完成」+「能量流动」音效 |
| 卸载物品 | 「能量断开」音效 |
| **点击切换配置按钮** | **「咔嚓」机械声** |
| **配置旋转中** | **持续的「嗡嗡」机械转动声** |
| **配置旋转完成** | **「咔嗒」锁定声** |
| 保存配置 | 「数据保存」音效 |

---

## 六、技术实现要点

### 1. 动效库（已集成）

使用 **PrimeTween** 实现所有 UI 动画：
- `Tween.Position`：物品移动
- `Tween.Scale`：缩放
- `Tween.Rotation`：旋转
- `Tween.Alpha`：淡入淡出
- `Tween.Custom`：自定义数值滚动效果

### 2. 组件结构

```
StarChartPanel (主面板)
├── ScanlineEffect (扫描线效果)
├── HoloBackground (全息背景)
├── TrackViewController (轨道视图)
│   ├── PrimaryTrackView
│   └── SecondaryTrackView
├── InventoryViewController (库存)
│   ├── CategoryTabs (分类标签)
│   └── ItemGridView (物品网格)
├── ItemTooltipView (悬停浮窗)
└── PresetManager (预设管理)
```

### 3. 浮窗组件 `ItemTooltipView`

```csharp
public class ItemTooltipView : MonoBehaviour
{
    [Header("References")]
    [SerializeField] private Image _iconImage;
    [SerializeField] private TextMeshProUGUI _nameText;
    [SerializeField] private TextMeshProUGUI _typeText;
    [SerializeField] private Transform _statsContainer;
    [SerializeField] private TextMeshProUGUI _descriptionText;
    
    [Header("Settings")]
    [SerializeField] private float _showDelay = 0.15f;
    [SerializeField] private Vector2 _offset = new Vector2(15, 15);
    
    private Coroutine _showCoroutine;
    private StarChartItemSO _currentItem;
    
    public void Show(StarChartItemSO item, Vector2 mousePosition)
    {
        if (_showCoroutine != null) StopCoroutine(_showCoroutine);
        _showCoroutine = StartCoroutine(ShowAfterDelay(item, mousePosition));
    }
    
    public void Hide()
    {
        if (_showCoroutine != null) StopCoroutine(_showCoroutine);
        AnimateHide();
    }
    
    public void UpdatePosition(Vector2 mousePosition)
    {
        Vector2 position = mousePosition + _offset;
        position.x = Mathf.Min(position.x, Screen.width - _rectTransform.rect.width);
        position.y = Mathf.Max(position.y, _rectTransform.rect.height);
        _rectTransform.position = position;
    }
}
```

---

## 七、MVP 拆分

### Phase 1：基础动效（1-2 天）
- 打开/关闭动画
- 简单的悬停效果
- 装备/卸载的缩放动画
- 集成音效（用现有 AudioManager）
- **背包乱斗紧凑布局**（槽位间距 2px，网格对齐）
- **动态格子扩展基础**（方案 C：混合方案的基础结构）

### Phase 2：交互增强（2-3 天）
- 悬停浮窗
- 拖拽拖尾效果
- **轨道悬停自动选中**（鼠标移到哪个轨道哪个高亮）
- **配置系统基础**（Loadout 数据结构，支持 3 个配置）
- 键盘快捷键（A/D/W/S 选择物品，Space 装备）
- **格子解锁动画**（新格子从"无"→"有"）

### Phase 3：加特林枪管旋转（3-4 天）⭐️
- **配置切换按钮**（侧边上下按钮：[▲] 上一个 / [▼] 下一个）
- **枪管旋转动效**（0.6s 旋转动画，垂直方向，从侧面看加特林枪管）
- **旋转视觉辅助**（枪管轮廓、震动效果、光影变化）
- **配置管理**（保存配置、重命名配置、删除配置）
- **Page Up / Page Down 快捷键切换配置**
- **旋转音效**（咔嚓、嗡嗡、咔嗒）
- **动态格子扩展完整实现**（混合方案，支持 1-40 格）

### Phase 4：完整科幻风格（2-3 天）
- 全息背景 + 扫描线
- 全新的 16:9 布局
- 兼容性提示

---

## 八、参考作品

| 游戏/媒介 | 值得借鉴的点 |
|-----------|-------------|
| **Backpack Battles** | 背包紧凑布局、网格对齐、策略感 |
| **Borderlands** | 武器轮盘、快速切换 |
| **Cyberpunk 2077** | HUD 风格、扫描线、全息效果 |
| **EVE Online** | 飞船装备界面、数值对比 |
| **Destiny 2** | 武器配置 UI、动效反馈 |
| **FTL: Faster Than Light** | 飞船系统界面的仪式感 |
| **Void Bastards** | 复古科幻 UI、排版风格 |
| **加特林机枪（真实）** | 枪管旋转的视觉效果、机械声音 |
| **Into the Breach** | 紧凑背包布局 |

---

## 九、总结

### 优势

| 优势 | 说明 |
|------|------|
| **横向利用** | 充分利用 16:9 宽度，库存一行显示 8-10 个物品 |
| **操作区在下方** | 符合手柄/键盘操作习惯 |
| **视觉聚焦在上** | 轨道在上方，装备效果一目了然 |
| **拖拽路径短** | 从底部库存拖到上方轨道，垂直移动顺手 |
| **更简洁** | 移除了固定面板，界面更清爽 |
| **更高效** | 不需要点击，悬停即看 |
| **更现代** | 符合现代游戏 UI 设计趋势 |

---

**文档结束**
